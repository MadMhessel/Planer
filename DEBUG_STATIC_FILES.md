# Отладка проблемы со статическими файлами

## Проблема
Статические файлы (JS, CSS) возвращают 500 ошибку вместо правильного контента.

## Шаги для диагностики

### 1. Проверьте логи Cloud Run при запуске сервера

```bash
gcloud run services logs read command-task-planner \
  --region us-west1 \
  --limit 50 \
  --format="table(timestamp,textPayload)"
```

Ищите строки:
- `✓ Static files directory found`
- `✓ Dist directory contains`
- `✓ Assets directory contains`

### 2. Проверьте логи при запросе к статическим файлам

Откройте в браузере:
- `https://command-task-planner-883668243599.us-west1.run.app/assets/index-C53v20yJ.js`

Затем проверьте логи:
```bash
gcloud run services logs tail command-task-planner \
  --region us-west1
```

Ищите строки:
- `Asset request: /assets/...`
- `File exists: true/false`
- `Available assets`

### 3. Проверьте, что файлы действительно в образе

Если логи показывают, что файлы не найдены, проверьте Docker образ:

```bash
# Соберите образ локально для тестирования
docker build -t test-image .

# Запустите контейнер
docker run --rm -it test-image sh

# Внутри контейнера проверьте
ls -la /app/dist/
ls -la /app/dist/assets/
```

### 4. Возможные причины

1. **Файлы не копируются в образ**
   - Проверьте `.dockerignore` - `dist` должен быть удален
   - Проверьте логи сборки Docker - должны быть файлы в `dist/assets/`

2. **Неправильный путь**
   - Проверьте логи сервера - какой путь используется
   - Убедитесь, что `distPath` правильный

3. **Права доступа**
   - В Alpine Linux могут быть проблемы с правами
   - Проверьте, что файлы читаемые

### 5. Временное решение

Если проблема критична, можно попробовать:

1. Использовать CDN для статических файлов
2. Встроить критичные CSS/JS в `index.html`
3. Использовать другой способ раздачи статики (nginx внутри контейнера)

## Текущие исправления

✅ Удален `dist` из `.dockerignore`
✅ Добавлен явный маршрут для `/assets/*`
✅ Добавлено детальное логирование
✅ Улучшена проверка в Dockerfile

## Следующие шаги

1. Закоммитьте изменения
2. Задеплойте новую версию
3. Проверьте логи Cloud Run
4. Если проблема останется - проверьте логи при запросе к assets

